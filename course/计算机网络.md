# 提纲
## 课程主要内容
- 计算机网络和互联网
- 应用层
- 传输层
- 网络层：数据平
- 网络层：控制平面
- 数据链路层和局域网
- 网络安全
- 无线和移动网络
- 多媒体网络
- 网络管理
## 第一章：概论
### 1.1什么是Internet
#### 1.1.1 节点：
- 主机及其上运行的应用程序
- 路由器、交换机等网络交换设备
#### 1.1.2 边：
- 接入网链路，主机连接到互联网的链路
- 主干链路，路由器间的链路

支撑互联网工作的标准
数以亿计的、互联的计算设备：
- 主机 = 端系统
- 运行网络网络应用程序

通信链路
- 光纤、同轴电缆、无线电、卫星
- 传输速率 = 带宽（bps）

分组交换设备：转发分组（packets）
- 路由器和交换机
#### 1.1.3 协议
协议控制发送、接收消息
- 如TCP、IP、HTTP、FTP、PPP

Internet：“网络的网络”
- 松散的层次结构、互联的ISP
- 公共Internet vs 专用internet

Internet标准
- RFC：Request for comments
- IETF：Internet Engineering Task Force 所有协议，以RFC格式发到IETF上，让全球工程师进行评审。群策群力构建互联网发展
#### 1.1.4 人类协议
- 几点啦？
- 我有个问题
- 你好
#### 1.1.5 网络协议
- 类似人类协议
- 机器之间的协议而非人与人之间的协议
- Internet中所有的通信行为都受协议制约
#### 1.1.6 定义
协议定义了在两个或多个通信实体之间交换的报文格式和次序，以及在报文传输和/或接收或其他事件方面所采取的动作
#### 1.1.7 使用通信设施进行通信的分布式应用
- web、VoIp、email、分布式游戏、电子商务、社交网络......
#### 1.1.8 通信基础设施为apps提供编程接口（通信服务）
- 将发送和接收数据的apps与互联网连接起来
- 为app应用提供服务选择，类似于邮政服务：
-- 无连接不可靠服务 UDP
-- 面向连接的可靠服务 TCP/IP

### 1.2 网络边缘
主机
应用程序（客户端和服务端）

端系统（主机）：
运行应用程序，如Web、email在“网络的边缘”

客户端/服务器模式：
客户端向服务器请求、接收服务，如Web浏览器/服务器：email客户端/服务器

对等（peer-peer）模式：
很少（甚至没有）专门的服务器，如迅雷

### 1.2.1 采用网络设施的面向连接服务
目标：在端系统之间传输数据
- 握手：在数据传输之前做好准备
  人类协议中：你好，你好
  两个通信主机之间为连接建立状态
- TCP - 传输控制协议 （Transmission Control Protocol）
  Internet上面向连接的服务

TCP服务
- 可靠的、按顺序地传送数据
  确认和重传
- 流量控制
  发送方不会淹没接收方
- 拥塞控制
  当网络拥塞时，发送方降低发送速率
### 1.2.2 采用基础设施的无连接服务
目标：在端系统之间传输数据
- 无连接服务
- UDP - 用户数据报协议（User Datagram Protocol）
  无连接、不可靠数据传输、无流量控制、无拥塞控制
### 1.2.3 两种连接的应用
使用TCP的应用：HTTP(Web), FTP(文件传送), Telnet(远程登录), SMTP(email)
使用UDP的应用：流媒体、远程会议、DNS、Internet电话
### 1.3 网路核心
路由器的网状结构
问题：数据是怎样通过网络进行传输的？
- 电路交换：为每个呼叫预留一条专有电路：如电话网
- 分组交换：
  - 将要传输的数据分为一个个单位，叫做分组
  - 将分组从一个路由器传到相邻路由器（hop），一段段最终从源端传到目标端
  - 每段：采用链路的最大传输能力（带宽）
### 1.3.1 电路交换
端到端的资源被分配给从源端到目标端到呼叫“call”
1）独享资源：不共享，每个呼叫一旦建立起来就能够保证性能
2）如果呼叫没有数据发送，被分配的资源就会被浪费
3）通常被传统电话网络采用
信道复用:
- 时分复用
- 频分复用
- 波分复用
### 1.3.2 电路交换结论
电路交换不适合计算机之间的通信
- 连接建立时间长
- 计算机之间的通信有突发性，如果使用线路交换，则浪费的片段比较多
  - 即使这个呼叫没有数据传输，其所占据的片也不能被别的呼叫使用
- 可靠性不高
### 1.3.3 分组交换
#### 以分组为单位存储-转发方式
- 网络带宽资源不再分为一个片，传输时使用全部带宽
- 主机之间传输的数据被分为一个个分组
#### 资源共享，按需使用
- 存储-转发：分组每次移动一跳（hop）
  - 在转发之前，节点必须收到整个分组
  - 延迟比电路交换大
  - 排队时间
  - 被传输到下一个链路之前，整个分组必须到达路由器：存储转发
  - 在一个速率为R bps的链路，一个长度为L bits的分组的存储转发延时：L/R s
#### 排队延迟和丢失
- 如果到达速率>链路的输出速率：
  - 分组将会排队，等待传输
  - 如果路由器的缓存用完了，分组将会被抛弃
#### 网络核心的关键功能
路由：决定分组采用的源到目标的路径  
转发：将分组从路由器的输入链路转移到输出链路
#### 分组交换：统计多路复用
随机的划分时间片来使用链路资源
#### 分组交换 vs 电路
分组交换支持更多用户同时使用，它是突发数据的胜利者
- 适合于对突发式数据传输
  - 资源共享
  - 简单，不必建立呼叫
- 过度使用会造成网络拥塞：分组延时于丢失
  - 对可靠地数据传输需要协议来约束：拥塞控制
#### datagram工作原理
- 在通信之前，无需建立起一个连接，有数据就传输
- 每一个分组都拥有独立路由（路径不一样，可能会失序）
- 路由器根据分组的目标地址进行路由
### 1.4 接入网和物理媒体
#### 住宅接入：modem
- 将上网数据调制加载音频信号上，将电话线上传输，在局端将其中的数据解调出来，反之依然
  - 调频
  - 调幅
  - 调相位
  - 综合调制
- 拨号调制解调器
  - 56Kbps的速率直接接入路由器（通常更低）
  - 不能同时上网和打电话，不能总是在线
#### 接入网：ditital subscriber line (DSL)
- 采用现存的到交换局DSLAM的电话线
  - DSL线路上的数据被传到互联网
  - DSL线路上的语音数据到电话网
- < 2.5Mbps上行传输速率
- < 24 Mbps下行传输速率
#### 接入网：线缆网络
有线电视信号线缆双向改造
FDM：在不同频段传输不同信道的数据
数字电视和上网数据（上下行）
- HFC: hybrid fiber coat
  - 非对称：最高30Mbps的下行传输速率，2Mbps上行传输速率
- 线缆和光纤网络将各个家庭用户接入到ISP路由器
- 各用户共享线缆头端的接入网络
  - 与DSL不同，DSL每个用户一个专用线路到CO（center office）
#### 物理媒体
- Bit：在发送-接收对间传播
- 物理链路：连接每个发送-接收对之间的物理媒体
- 导引型媒体：信号沿着固体媒介被导引，同轴电缆、光纤、双绞线
- 非导引型媒体：开放的空间传输电磁波或者光信号中承载数字信号
- 双绞线
  - 两根绝缘铜导线拧合
    - 5类：100Mbps以太网，Gbps千兆以太网
    - 6类：10Gbps万兆以太网
- 同轴电缆
  - 两根同轴的铜导线
  - 双向
  - 基带电缆：
    - 电缆上一个单个信道
    - Ethernet
  - 宽带电缆：
    - 电缆上有多个信道
    - HFC
- 光纤和光缆：
  - 光脉冲，每个脉冲表示一个bit，在玻璃纤维中传输
  - 高速：
    - 点到点的高速传输（如10Gbps-100Gbps传输速率）
  - 低误码率：在两个中继器之间可以有很长的距离，不受电磁噪声的干扰
  - 安全
- 无线链路类型
  - 地面微波
  - LAN
  - wide-area
  - 卫星
    - 每个信道Kbps到45Mbps
    - 270 msec端到端延迟
    - 同步静止卫星和低轨卫星
### 1.5 Internet结构和ISP
#### 互联网络结构：网络的网络
- 端系统通过接入ISPs连接到互联网
  - 住宅，公司和大学的ISPs
- 接入ISPs相应的必须是互联的
  - 因此任何两个端系统可互相发送分组到对方
- 导致的“网络的网络”非常复杂
  - 发展和演化是通过经济的和国家的政策来驱动的
- 让我们采用渐进方法来描述当前互联网的结构

如何连接所有ISP
利用global ISP
客户ISPs和提供者ISPs有经济合约
竞争：如果全局ISP是有利可为的业务，那会有竞争者
合作：通过ISP之间的合作可以完成业务的拓展，肯定会有互联，对等互联的结算关系
互联网内容提供商（Internet Content Provider e.g. Google, Baidu）
如美国谷歌服务器，给南非客户提供服务，需要很多跳，费用高昂。这时候谷歌就会考虑自己构建（租或搭）它的网络，一般靠近核心ISP，将它们的服务、内容更加靠近端用户，向用户提供更好的服务，减少自己的运营支出
结构：
- 松散的层次模型
- 中心：第一层ISP国家/国际覆盖，速率极高
  - 直接与其他第一层ISP项链
  - 与大量的第二层ISP和其他客户网络相连
- 第二层ISP：更小些的ISP
  - 与一个或多个第一层ISPs，也可能与其他第二层ISP
- 第三层ISP与其他本地ISP
  - 接入网（与端系统最近）
#### ISP之间的连接
- POP：高层ISP面向客户网络的接入点，涉及费用结算
  - 如一个底层ISP接入多个高层ISP，多宿
- 对等接入：2个ISP对等互接，不涉及费用结算
- IXP，多个对等ISP互联互通之处，通常不涉及费用结算
  - 对等接入
- ICP自己部署专用网络，同时和各级ISP连接
### 1.6 分组延时、丢失和吞吐量
#### 分组丢失和延时的原因
在路由器缓冲区的分组队列
- 分组到达链路的速率超过了链路输出的能力
- 分组等待排到队头、被传输
#### 四种分组延时
1. 节点处理延时
   - 检查bit级差错
   - 检查分组首部和决定将分组导向何处
2. 排队延时
   - 在输出链路上等待传输的时间
   - 依赖于路由器的拥塞程度
3. 传输延时
   - R=链路带宽(bps)
   - L=分组长度(bps)
   - 将分组发送到链路上的时间L/R
   - 存储转发延时
4. 传播延时
   - d = 物理链路的长度
   - s = 在媒体上的传播速度($2*10^{8}m/sec$)
   - 传播延时 = d/s

节点延时（每一跳）
$$d_{nodal}=d_{proc}+d_{queue}+d_{trans}+d_{prop}$$
- $d_{proc}$=处理延时
  - 通常是微妙数量级或更少
- $d_{queue}$=排队延时
  - 取决于拥塞程度
- $d_{trans}$=传输延时
  - =L/R，对低速率的链路而言很大（如拨号），通常为微秒级到毫秒级
- $d_{prop}$=传播延时
  - 几微秒到几百毫秒
#### 排队延时
- R=链路带宽(bps)
- L=分组长度(bits)
- a=分组到达队列的平均速率
- 流量强度 = La/R
  - La/R ~ 0:平均排队延时很小
  - La/R -> 1:延时变得很大
  - La/R > 1:比特到达队列的速率超过了从该队列输出的速率，平均排队延时将趋于无穷大
#### 分组丢失
- 链路的队列缓冲区容量有限
- 当分组到达一个满的队列时，该分组将会丢失
- 丢失的分组可能会被前一个节点（链路层可靠）或源端系统重传（TCP），或根本不重传（UDP）
#### 吞吐量
- 在源端和目标端之间传输的速率（数据量/单位时间）
  - 瞬间吞吐量：在一个时间点的速率
  - 平均吞吐量：在一个长时间内平均值
- 瓶颈链路：端到端路径上，限制端到端吞吐的链路
### 1.7 协议层次及服务模型
### 1.8 历史
